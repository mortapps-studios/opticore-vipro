<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, minimum-scale=1.0, user-scalable=yes, viewport-fit=cover">
    <title>Opticore ViPro | Professional Virtual Eyewear Analysis</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Face-API.js library with CDN models -->
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    
    <!-- Mobile PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1a2980">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="manifest" href="manifest.json">
</head>
<body oncontextmenu="return false;">
    <!-- Loading Screen (4.2 seconds) -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <div class="pulse-ring"></div>
                <i class="fas fa-eye"></i>
                <div class="corner-dots">
                    <span></span><span></span><span></span><span></span>
                </div>
            </div>
            <h1 class="loading-title">Opticore <span class="vi-pro">ViPro</span></h1>
            <p class="loading-subtitle">Powered By MortApps Studios</p>
            <div class="loading-progress">
                <div class="progress-bar"></div>
            </div>
            <div class="loading-tagline">Initializing Visual Intelligence</div>
        </div>
    </div>

    <!-- Popup Overlays -->
    <div id="howItWorksPopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3><i class="fas fa-info-circle"></i> How It Works</h3>
                <button class="popup-close">&times;</button>
            </div>
            <div class="popup-body">
                <!-- NEW: Professional SmartMode Instructions -->
                <div class="engineer-note">
                    <i class="fas fa-microchip"></i>
                    <span><strong>PRO TIP:</strong> Activate our proprietary <span style="color: var(--accent-teal);">Neural Calibration Layer</span> by pressing <code>Ctrl + D</code> (Windows) or <code>Cmd + D</code> (Mac) to view real-time biometric tracking data.</span>
                </div>
                
                <div class="instruction-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>Camera Activation</h4>
                        <p>Click "Start Visual Analysis" to enable your camera. Access is required for real-time facial mapping.</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>Frame Selection</h4>
                        <p>Choose from our curated collection of precision eyewear. Each selection updates in real-time.</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>Precision Adjustment</h4>
                        <div class="adjustment-instructions">
                            <div class="adjustment-item">
                                <span class="key">+</span>
                                <span>Increase frame dimensions</span>
                            </div>
                            <div class="adjustment-item">
                                <span class="key">-</span>
                                <span>Decrease frame dimensions</span>
                            </div>
                            <div class="adjustment-item">
                                <span class="key">↑/↓</span>
                                <span>Vertical positioning</span>
                            </div>
                            <div class="adjustment-item">
                                <span class="key">←/→</span>
                                <span>Horizontal positioning</span>
                            </div>
                        </div>
                        <p class="mobile-note"><i class="fas fa-mobile-alt"></i> On mobile: Pinch to resize, drag to reposition.</p>
                    </div>
                </div>
                <div class="instruction-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>Results Delivery</h4>
                        <p>Select "Send Analysis" to securely transmit your personalized eyewear assessment.</p>
                    </div>
                </div>
            </div>
            <div class="popup-footer">
                <button class="btn-primary start-try-on-btn">
                    <i class="fas fa-play"></i> Begin Analysis
                </button>
            </div>
        </div>
    </div>

    <div id="privacyPopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3><i class="fas fa-shield-alt"></i> Privacy & Security Protocol</h3>
                <button class="popup-close">&times;</button>
            </div>
            <div class="popup-body">
                <div class="security-badge">
                    <i class="fas fa-lock"></i>
                    <span>100% Device-Local Processing</span>
                </div>
                <p class="privacy-statement">
                    The Opticore ViPro system operates under strict privacy protocols. All facial recognition, frame mapping, and visual analysis occur exclusively within your device's secure environment.
                </p>
                <div class="privacy-points">
                    <div class="privacy-point">
                        <i class="fas fa-check-circle"></i>
                        <span>Zero image transmission to external servers</span>
                    </div>
                    <div class="privacy-point">
                        <i class="fas fa-check-circle"></i>
                        <span>No facial data storage or retention</span>
                    </div>
                    <div class="privacy-point">
                        <i class="fas fa-check-circle"></i>
                        <span>Real-time processing with immediate memory clearance</span>
                    </div>
                    <div class="privacy-point">
                        <i class="fas fa-check-circle"></i>
                        <span>Military-grade local encryption protocols</span>
                    </div>
                </div>
                <p class="security-note">
                    Your visual privacy is paramount. The system is designed for healthcare and eyewear professionals who require absolute client confidentiality.
                </p>
            </div>
        </div>
    </div>

    <div id="contactPopup" class="popup-overlay">
        <div class="popup-content">
            <div class="popup-header">
                <h3><i class="fas fa-headset"></i> Professional Consultation</h3>
                <button class="popup-close">&times;</button>
            </div>
            <div class="popup-body">
                <p>Connect with our optical technology specialists:</p>
                <div class="contact-options">
                    <button class="contact-option-btn call-option">
                        <i class="fas fa-phone"></i>
                        <div>
                            <strong>Direct Call</strong>
                            <small>+254 113 400 063</small>
                        </div>
                    </button>
                    <button class="contact-option-btn whatsapp-option">
                        <i class="fab fa-whatsapp"></i>
                        <div>
                            <strong>WhatsApp Consultation</strong>
                            <small>+254 113 400 063</small>
                        </div>
                    </button>
                </div>
                <p class="contact-note">
                    <i class="fas fa-clock"></i> Available: Mon-Fri 8:00-18:00 EAT
                </p>
            </div>
        </div>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <i class="fas fa-eye"></i>
                <span>Opticore <strong>ViPro</strong></span>
            </div>
            <div class="nav-links">
                <a href="#" class="active">Visual Analysis</a>
                <a href="#" id="framesLink">Frames</a>
                <a href="#" id="howItWorksLink">How It Works</a>
                <a href="#" id="privacyLink">Privacy</a>
                <button class="btn-contact" id="contactLink">Consultation</button>
            </div>
            <button class="mobile-menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </nav>

    <!-- Main Container -->
    <main class="container">
        <!-- Left Panel: Try-On Area -->
        <div class="try-on-container">
            <div class="section-header">
                <h1><i class="fas fa-atom"></i> Visual Analysis Studio</h1>
                <p class="subtitle">Precision eyewear fitting with advanced facial mapping technology</p>
            </div>

            <!-- Camera/Canvas Area -->
            <div class="camera-section">
                <!-- Video Feed (hidden but active) -->
                <video id="videoElement" class="video-feed" autoplay playsinline></video>
                
                <!-- Canvas where magic happens -->
                <canvas id="canvasElement" class="canvas-overlay"></canvas>
                
                <!-- Fallback Static Image -->
                <div id="staticContainer" class="static-fallback">
                    <img src="assets/static-model.jpg" alt="Reference facial structure for analysis" id="staticModel">
                    <!-- Draggable glasses will appear here in static mode -->
                    <img src="assets/glasses/frame1.png" alt="Selected eyewear frame" id="staticGlasses" class="draggable-glasses">
                </div>

                <!-- Status Overlays -->
                <div id="loadingOverlay" class="overlay">
                    <div class="loading-spinner"></div>
                    <p>Initializing Visual Intelligence <span id="loadingText">Standby</span></p>
                </div>

                <div id="permissionOverlay" class="overlay permission-prompt">
                    <i class="fas fa-camera fa-3x"></i>
                    <h3>Camera Access Required</h3>
                    <p>For precise facial mapping, camera access is necessary.</p>
                    <p class="small-text"><i class="fas fa-shield-alt"></i> 100% local processing - No data leaves your device</p>
                    <button id="startCameraBtn" class="btn-primary btn-large">
                        <i class="fas fa-play-circle"></i> Start Visual Analysis
                    </button>
                    <button id="useStaticModeBtn" class="btn-secondary">
                        <i class="fas fa-image"></i> Use Reference Image
                    </button>
                </div>

                <!-- Mobile Controls Overlay -->
                <div id="mobileControls" class="mobile-controls-overlay">
                    <div class="mobile-controls">
                        <button class="mobile-control-btn" data-action="zoom-in">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="mobile-control-btn" data-action="zoom-out">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <div class="mobile-control-separator"></div>
                        <button class="mobile-control-btn" data-action="move-up">
                            <i class="fas fa-arrow-up"></i>
                        </button>
                        <button class="mobile-control-btn" data-action="move-down">
                            <i class="fas fa-arrow-down"></i>
                        </button>
                        <div class="mobile-control-separator"></div>
                        <button class="mobile-control-btn" data-action="move-left">
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <button class="mobile-control-btn" data-action="move-right">
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <div class="mobile-control-separator"></div>
                        <!-- Neural Calibration Layer Toggle for Mobile -->
                        <button class="mobile-control-btn neural-toggle-btn" id="neuralToggleMobile" data-action="toggle-neural">
                            <i class="fas fa-brain"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Control Panel -->
            <div class="control-panel">
                <div class="controls-grid">
                    <button id="toggleCameraBtn" class="btn-control">
                        <i class="fas fa-video"></i> <span>Camera: <span id="cameraStatus">Standby</span></span>
                    </button>
                    <button id="captureBtn" class="btn-control btn-success">
                        <i class="fas fa-camera-retro"></i> Capture Analysis
                    </button>
                    <button id="downloadBtn" class="btn-control">
                        <i class="fas fa-download"></i> Download
                    </button>
                    <button id="shareBtn" class="btn-control" disabled>
                        <i class="fas fa-share-alt"></i> Share
                    </button>
                    <button id="resetBtn" class="btn-control">
                        <i class="fas fa-sync-alt"></i> Reset
                    </button>
                    <!-- Neural Calibration Layer Toggle for Desktop -->
                    <button id="neuralToggleDesktop" class="btn-control neural-toggle-btn">
                        <i class="fas fa-brain"></i> <span>Neural Layer: <span id="neuralStatus">OFF</span></span>
                    </button>
                </div>

                <!-- Lighting Controls -->
                <div class="lighting-controls">
                    <h4><i class="fas fa-sun"></i> Lighting</h4>
                    <div class="lighting-options">
                        <button class="light-btn active" data-filter="none">Normal</button>
                        <button class="light-btn" data-filter="brightness(1.2) contrast(1.1)">Bright</button>
                        <button class="light-btn" data-filter="brightness(0.9) sepia(0.1)">Evening</button>
                        <button class="light-btn" data-filter="saturate(1.3)">Vibrant</button>
                    </div>
                </div>

                <!-- Adjustment Controls -->
                <div class="adjustment-controls">
                    <h4><i class="fas fa-sliders-h"></i> Frame Adjustments</h4>
                    
                    <!-- Size Controls -->
                    <div class="adjustment-section">
                        <label class="adjustment-label">Size Adjustment</label>
                        <div class="adjustment-row">
                            <button class="adjust-btn" data-adjust="size-up">
                                <i class="fas fa-plus"></i> Increase Size
                            </button>
                            <button class="adjust-btn" data-adjust="size-down">
                                <i class="fas fa-minus"></i> Decrease Size
                            </button>
                        </div>
                    </div>

                    <!-- Position Controls -->
                    <div class="adjustment-section">
                        <label class="adjustment-label">Position Adjustment</label>
                        <div class="position-controls">
                            <div class="position-row">
                                <button class="adjust-btn position-btn" data-adjust="position-up">
                                    <i class="fas fa-arrow-up"></i>
                                </button>
                            </div>
                            <div class="position-row">
                                <button class="adjust-btn position-btn" data-adjust="position-left">
                                    <i class="fas fa-arrow-left"></i>
                                </button>
                                <button class="adjust-btn position-btn" data-adjust="position-down">
                                    <i class="fas fa-arrow-down"></i>
                                </button>
                                <button class="adjust-btn position-btn" data-adjust="position-right">
                                    <i class="fas fa-arrow-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Keyboard Hint -->
                    <div class="keyboard-hint">
                        <i class="fas fa-keyboard"></i>
                        <small>Use + / - keys for size, Arrow keys for position</small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Panel: Frame Selection -->
        <div class="selection-panel" id="framesSection">
            <div class="panel-header">
                <h2><i class="fas fa-glasses"></i> Select Precision Frames</h2>
                <div class="frame-count">12 professional models</div>
            </div>

            <!-- Filter Tabs -->
            <div class="filter-tabs">
                <button class="filter-btn active">All Collections</button>
                <button class="filter-btn">Professional</button>
                <button class="filter-btn">Contemporary</button>
                <button class="filter-btn">Classic Design</button>
            </div>

            <!-- Glasses Grid -->
            <div class="glasses-grid" id="glassesGrid">
                <!-- Glasses cards will be generated by JavaScript -->
            </div>

            <!-- Selection Summary -->
            <div class="selection-summary">
                <h3><i class="fas fa-clipboard-check"></i> Analysis Summary</h3>
                <div id="selectedFrameDisplay" class="selected-frame">
                    <img id="selectedFrameImg" src="assets/glasses/frame1.png" alt="Selected Frame">
                    <div>
                        <h4 id="selectedFrameName">Classic Thick-Rim Rectangular</h4>
                        <p id="selectedFramePrice">Professional Grade</p>
                    </div>
                </div>
                <button id="sendToWhatsAppBtn" class="btn-primary btn-full-width">
                    <i class="fab fa-whatsapp"></i> Send Analysis for Consultation
                </button>
                <p class="privacy-note">
                    <i class="fas fa-shield-alt"></i> 
                    <strong>Secure Transmission:</strong> Analysis data is encrypted end-to-end via WhatsApp.
                </p>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4><i class="fas fa-eye"></i> Opticore ViPro</h4>
                <p>Advanced optical analysis platform for precision eyewear fitting and visual health assessment.</p>
            </div>
            <div class="footer-section">
                <h4>Capabilities</h4>
                <ul>
                    <li>Real-time facial biometric mapping</li>
                    <li>100% client-side visual processing</li>
                    <li>Professional-grade frame analysis</li>
                    <li>Secure encrypted consultation system</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>For Professionals</h4>
                <p class="professional-note">
                    Used by optical clinics, eyewear retailers, and healthcare providers for precise client consultations.
                </p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Engineered with <span class="heartbeat"><i class="fas fa-heart"></i></span> by <a href="https://www.mortappsstudios.com" target="_blank">MortApps Studios</a></p>
            <p class="copyright">©2026 Opticore ViPro. Advanced Optical Technology.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="script.js"></script>
</body>
</html>
